# MFA (Multi-Factor Authentication) Configuration Example

[security.mfa]
enabled = true
required_for_all = false
required_roles = ["admin", "developer"]

[security.mfa.totp]
enabled = true
algorithm = "Sha256"  # Options: Sha1, Sha256, Sha512
digits = 6            # 6 or 8 digits
period = 30           # Time step in seconds
time_window = 1       # Allow Â±1 time step

[security.mfa.backup_codes]
enabled = true
count = 10            # Number of backup codes to generate
length = 12           # Length of each code (characters)
use_separators = true # Use separators (e.g., XXXX-XXXX-XXXX)

[security.mfa.sms]
enabled = true
code_length = 6              # Length of verification code (digits)
expiration_seconds = 300     # Code expiration time (5 minutes)
max_attempts = 3             # Maximum verification attempts

[security.mfa.sms.provider]
type = "Mock"  # Options: Mock, Twilio, AwsSns, Custom

# Example Twilio configuration
# [security.mfa.sms.provider]
# type = "Twilio"
# account_sid = "your_account_sid"
# auth_token = "your_auth_token"
# from_number = "+1234567890"

# Example AWS SNS configuration
# [security.mfa.sms.provider]
# type = "AwsSns"
# region = "us-east-1"
# access_key_id = "your_access_key"
# secret_access_key = "your_secret_key"

# Example Custom HTTP provider
# [security.mfa.sms.provider]
# type = "Custom"
# endpoint = "https://api.example.com/sms/send"
# api_key = "your_api_key"
# method = "POST"

# Device Trust Configuration
[security.mfa.device_trust]
enabled = true                     # Enable/disable device trust
max_devices_per_user = 5          # Maximum trusted devices per user
token_validity_seconds = 2592000  # 30 days in seconds (0 = never expire)
require_mfa_on_new_device = true  # Require MFA when accessing from new device

# Session-Level MFA Configuration
[security.mfa.session]
enabled = true                          # Enable session-level MFA
require_for_all_sessions = false        # Require MFA even for trusted devices
challenge_expiration_seconds = 300      # MFA challenge expiration (5 minutes)
max_attempts = 3                        # Maximum verification attempts per challenge
session_validity_seconds = 0            # MFA session validity (0 = entire session)
